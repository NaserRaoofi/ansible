---
# ğŸ¯ MASTER SITE PLAYBOOK - Enterprise Deployment
# Main orchestration playbook for all environments
# Usage: ansible-playbook -i inventories/production/hosts playbooks/site.yml

- name: "ğŸ” Pre-deployment Validation"
  hosts: all
  gather_facts: true
  tags: [validation, pre-deployment]
  
  tasks:
    - name: "ğŸ“‹ Validate Environment"
      assert:
        that:
          - ansible_os_family is defined
          - environment_name is defined
        fail_msg: "âŒ Environment validation failed"
        success_msg: "âœ… Environment validation passed"

- name: "ğŸ§ª Connectivity Test"
  import_playbook: connect-test.yml
  tags: [connectivity, testing]

- name: "ğŸ”§ Install Essential Tools"
  import_playbook: install-tools.yml
  tags: [tools, installation]

- name: "ğŸ­ Enterprise Deployment"
  import_playbook: enterprise-deployment.yml
  tags: [deployment, production]

- name: "ğŸ“Š Post-deployment Summary"
  hosts: all
  gather_facts: false
  
  tasks:
    - name: "ğŸ¯ Deployment Complete"
      debug:
        msg: |
          
          â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
          â•‘              ğŸ‰ DEPLOYMENT COMPLETED SUCCESSFULLY           â•‘
          â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          
          ğŸŒ Environment: {{ environment_name | upper }}
          ğŸ“± Application: {{ app_name }}
          ğŸ–¥ï¸  Servers: {{ groups['all'] | length }}
          â° Completed: {{ ansible_date_time.iso8601 }}
          
          ğŸ¯ NEXT STEPS:
          1. Monitor application health
          2. Review logs for any issues
          3. Update monitoring dashboards
          4. Notify stakeholders
